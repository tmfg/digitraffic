<!-- The initial config of Consent Mode -->
<script type="text/javascript">
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('consent', 'default', {
    ad_storage: 'denied',
    analytics_storage: 'denied',
    wait_for_update: 1500,
  });
  gtag('set', 'ads_data_redaction', true);

  function askConsent() {
    let langCode = "EN";
    if (navigator.language.substring(0,2) === "fi") {
      langCode = "FI";
    }
    if ( window.location.host.endsWith("digitraffic.fi") ) {
      const script = document.createElement('script');
      script.type='text/javascript';
      script.id="CookieConsent";
      script.setAttribute("data-culture", {% if page.lang == "fi" %}"FI"{% else %}"EN"{% endif %});
      script.src = 'https://policy.app.cookieinformation.com/uc.js';
      document.getElementsByTagName('head')[0].appendChild(script);
    }
  }

  /* Ask consent when dom is fully loaded */
  document.addEventListener("DOMContentLoaded", askConsent);
  /* Document already fully loaded? Just ask as event won't be fired anymore */
  if ( document.readyState === "complete" ) {
    askConsent();
  }
</script>
